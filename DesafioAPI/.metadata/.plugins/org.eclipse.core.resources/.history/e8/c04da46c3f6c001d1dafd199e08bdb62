package com.gft.services;

import java.util.Optional;

import javax.persistence.EntityNotFoundException;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;
import org.springframework.stereotype.Service;

import com.gft.entities.Etiqueta;
import com.gft.repositories.EtiquetaRepository;
import com.gft.repositories.HistoricoRepository;
import com.gft.repositories.UsuarioRepository;

@Service
public class EtiquetaService {

	@Autowired
	private HistoricoRepository historicoRepository;
	
	@Autowired
	private UsuarioRepository usuarioRepository;
	
	private final EtiquetaRepository etiquetaRepository;

	public EtiquetaService(EtiquetaRepository etiquetaRepository) {
		this.etiquetaRepository = etiquetaRepository;
	}
	
	public Etiqueta salvarEtiqueta(Etiqueta etiqueta) {
			historicoRepository.save(etiqueta);
			return etiquetaRepository.save(etiqueta);
		}
	public Page<Etiqueta> listarTodasEtiquetas(Pageable pageable){
		
		return etiquetaRepository.findAll(pageable);
	}
	
	public Etiqueta buscarEtiqueta(Long id) {
		Optional<Etiqueta> optional= etiquetaRepository.findById(id);
		
		return optional.orElseThrow(() -> new EntityNotFoundException("Etiqueta não encontrado."));
	}
	
	public Etiqueta buscarEtiqueta(String etiqueta) {
		Optional<Etiqueta> optional= etiquetaRepository.findByNome(etiqueta);
		
		return optional.orElseThrow(() -> new EntityNotFoundException("Etiqueta não encontrado."));
	}
	public Etiqueta atualizarEtiqueta(Etiqueta etiqueta, Long id) {
		
		Etiqueta etiquetaOriginal = this.buscarEtiqueta(id);
		
		etiqueta.setId(etiquetaOriginal.getId());
		
		return etiquetaRepository.save(etiqueta);
	}
	
	public void excluirEtiqueta(Long id) {
		
		Etiqueta etiquetaOriginal = this.buscarEtiqueta(id); 
		etiquetaRepository.delete(etiquetaOriginal);
		
	}
}